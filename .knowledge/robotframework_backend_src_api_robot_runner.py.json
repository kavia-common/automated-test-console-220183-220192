{"is_source_file": true, "format": "Python", "description": "This file defines a Python class 'RobotRunController' that manages execution of Robot Framework test runs asynchronously, handling process lifecycle, logging, and database updates. It features methods to initiate, stop, get current run info, and stream logs. The code integrates with SQLAlchemy for database operations and uses asyncio for concurrency.", "external_files": ["robot", "src.core.settings", "src.db.repositories", "src.db.database"], "external_methods": ["robot.run_cli", "src.core.settings.settings", "src.db.repositories.create_test_run", "src.db.repositories.finalize_test_run", "src.db.repositories.add_batch_log", "src.db.repositories.add_fail_log", "src.db.repositories.count_case_status", "src.db.database.SessionLocal"], "published": ["controller"], "classes": [{"name": "RobotRunController", "description": "Controls a single Robot Framework run and its process lifecycle, managing execution, logging, and database updates asynchronously."}], "methods": [{"name": "Dict[str,Any] run( self, project: Optional[str] = None, suite: Optional[str] = None, tests: Optional[List[str]] = None, include_tags: Optional[List[str]] = None, exclude_tags: Optional[List[str]] = None, variables: Optional[Dict[str, Any]] = None, loop: int = 1, dry_run: bool = False, batch: bool = False, )", "description": "Schedules and executes a Robot Framework run asynchronously, returning metadata about the scheduled run.", "scope": "RobotRunController", "scopeKind": "class"}, {"name": "None _execute_robot( self, log_dir: str, project: Optional[str], suite: Optional[str], tests: Optional[List[str]], include_tags: Optional[List[str]], exclude_tags: Optional[List[str]], variables: Optional[Dict[str, Any]], loop: int, dry_run: bool, batch: bool, )", "description": "Internal method to execute the Robot Framework process with specified parameters, handle loops, update logs and database.", "scope": "RobotRunController", "scopeKind": "class"}, {"name": "Dict[str,Any] stop(self)", "description": "Signals the current running process to stop and returns whether a stop was initiated.", "scope": "RobotRunController", "scopeKind": "class"}, {"name": "Optional[int] get_current_run(self)", "description": "Returns the ID of the current run if active, otherwise None.", "scope": "RobotRunController", "scopeKind": "class"}, {"name": "Optional[str] get_log_file(self)", "description": "Returns the current log file path if a run is active.", "scope": "RobotRunController", "scopeKind": "class"}, {"name": "None set_expected_total(self, total: int)", "description": "Sets the expected total number of test cases for current run.", "scope": "RobotRunController", "scopeKind": "class"}, {"name": "int get_expected_total(self)", "description": "Retrieves the expected total number of test cases for current run.", "scope": "RobotRunController", "scopeKind": "class"}, {"name": "Dict[str,Any] get_current_case_info(self)", "description": "Returns information about the currently running test case.", "scope": "RobotRunController", "scopeKind": "class"}, {"name": "AsyncGenerator[str,None] stream_log(self)", "description": "Asynchronously yields new log lines from the current log file for real-time streaming.", "scope": "RobotRunController", "scopeKind": "class"}, {"name": "None __init__(self)", "scope": "RobotRunController", "scopeKind": "class", "description": "unavailable"}, {"name": "List[str] build_args()", "scope": "RobotRunController._execute_robot", "scopeKind": "member", "description": "unavailable"}, {"name": "None write_line(msg: str)", "scope": "RobotRunController._execute_robot", "scopeKind": "member", "description": "unavailable"}], "calls": ["asyncio.create_task", "asyncio.to_thread", "asyncio.sleep", "os.makedirs", "os.path.join", "os.path.exists", "os.path.getsize", "datetime.utcnow", "time.time", "run_cli", "create_test_run", "finalize_test_run", "add_batch_log", "add_fail_log", "count_case_status"], "search-terms": ["RobotRunController", "run_cli", "asyncio", "robot", "test_run", "log_streaming", "scheduling robot runs", "database test run management", "log tailing"], "state": 2, "file_id": 14, "knowledge_revision": 43, "git_revision": "68f97cc4cc0da114d8a101e32b413fc1281600e0", "revision_history": [{"36": ""}, {"43": "68f97cc4cc0da114d8a101e32b413fc1281600e0"}], "ctags": [{"_type": "tag", "name": "RobotRunController", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/api/robot_runner.py", "pattern": "/^class RobotRunController:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/api/robot_runner.py", "pattern": "/^    def __init__(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "RobotRunController", "scopeKind": "class"}, {"_type": "tag", "name": "_execute_robot", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/api/robot_runner.py", "pattern": "/^    async def _execute_robot($/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "( self, log_dir: str, project: Optional[str], suite: Optional[str], tests: Optional[List[str]], include_tags: Optional[List[str]], exclude_tags: Optional[List[str]], variables: Optional[Dict[str, Any]], loop: int, dry_run: bool, batch: bool, )", "scope": "RobotRunController", "scopeKind": "class"}, {"_type": "tag", "name": "build_args", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/api/robot_runner.py", "pattern": "/^        def build_args() -> List[str]:$/", "file": true, "language": "Python", "typeref": "typename:List[str]", "kind": "function", "signature": "()", "scope": "RobotRunController._execute_robot", "scopeKind": "member"}, {"_type": "tag", "name": "controller", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/api/robot_runner.py", "pattern": "/^controller = RobotRunController()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "get_current_case_info", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/api/robot_runner.py", "pattern": "/^    def get_current_case_info(self) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self)", "scope": "RobotRunController", "scopeKind": "class"}, {"_type": "tag", "name": "get_current_run", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/api/robot_runner.py", "pattern": "/^    def get_current_run(self) -> Optional[int]:$/", "language": "Python", "typeref": "typename:Optional[int]", "kind": "member", "signature": "(self)", "scope": "RobotRunController", "scopeKind": "class"}, {"_type": "tag", "name": "get_expected_total", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/api/robot_runner.py", "pattern": "/^    def get_expected_total(self) -> int:$/", "language": "Python", "typeref": "typename:int", "kind": "member", "signature": "(self)", "scope": "RobotRunController", "scopeKind": "class"}, {"_type": "tag", "name": "get_log_file", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/api/robot_runner.py", "pattern": "/^    def get_log_file(self) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "member", "signature": "(self)", "scope": "RobotRunController", "scopeKind": "class"}, {"_type": "tag", "name": "run", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/api/robot_runner.py", "pattern": "/^    async def run($/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "( self, project: Optional[str] = None, suite: Optional[str] = None, tests: Optional[List[str]] = None, include_tags: Optional[List[str]] = None, exclude_tags: Optional[List[str]] = None, variables: Optional[Dict[str, Any]] = None, loop: int = 1, dry_run: bool = False, batch: bool = False, )", "scope": "RobotRunController", "scopeKind": "class"}, {"_type": "tag", "name": "set_expected_total", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/api/robot_runner.py", "pattern": "/^    def set_expected_total(self, total: int) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, total: int)", "scope": "RobotRunController", "scopeKind": "class"}, {"_type": "tag", "name": "stop", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/api/robot_runner.py", "pattern": "/^    async def stop(self) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self)", "scope": "RobotRunController", "scopeKind": "class"}, {"_type": "tag", "name": "stream_log", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/api/robot_runner.py", "pattern": "/^    async def stream_log(self) -> AsyncGenerator[str, None]:$/", "language": "Python", "typeref": "typename:AsyncGenerator[str,None]", "kind": "member", "signature": "(self)", "scope": "RobotRunController", "scopeKind": "class"}, {"_type": "tag", "name": "write_line", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/api/robot_runner.py", "pattern": "/^        def write_line(msg: str) -> None:$/", "file": true, "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(msg: str)", "scope": "RobotRunController._execute_robot", "scopeKind": "member"}], "hash": "09183f1626b4b86c5c0ff5772c41cdaf", "format-version": 4, "code-base-name": "robotframework_backend", "filename": "robotframework_backend/src/api/robot_runner.py", "fields": [{"name": "controller = RobotRunController()", "scope": "", "scopeKind": "", "description": "unavailable"}]}