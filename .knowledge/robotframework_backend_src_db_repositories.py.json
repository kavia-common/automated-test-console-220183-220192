{"is_source_file": true, "format": "Python", "description": "This file contains repository functions for managing test run data, including creating, updating, and retrieving test run and test case result information, as well as logging related data. It interacts with a database using SQLAlchemy ORM models and session management.", "external_files": ["src/db/models.py"], "external_methods": ["session.add", "session.commit", "session.refresh", "session.get", "session.execute", "scalars", "select", "func.sum", "func.count", "desc"], "published": ["create_test_run", "finalize_test_run", "add_case_result", "add_batch_log", "add_fail_log", "get_recent_runs", "get_run_stats", "count_case_status"], "classes": [], "methods": [{"name": "models.TestRun create_test_run( db: Session, project: Optional[str] = None, suite_name: Optional[str] = None, total_cases: int = 0, logs_path: Optional[str] = None, )", "description": "Creates and persists a new TestRun record with 'running' status, initializing key fields including start time.", "scope": "", "scopeKind": ""}, {"name": "Optional[models.TestRun] finalize_test_run( db: Session, run_id: int, status: str, passed: int, failed: int )", "description": "Marks an existing TestRun as finished, updating end time, status, and result counts, or returns None if not found.", "scope": "", "scopeKind": ""}, {"name": "models.TestCaseResult add_case_result( db: Session, run_id: int, case_name: str, status: str, duration_sec: Optional[float] = None, message: Optional[str] = None, suite_name: Optional[str] = None, start_time: Optional[datetime] = None, end_time: Optional[datetime] = None, tags: Optional[str] = None, )", "description": "Creates and stores a TestCaseResult linked to a specific test run, with details about the test case outcome.", "scope": "", "scopeKind": ""}, {"name": "models.BatchLog add_batch_log( db: Session, run_id: int, message: str, level: str = \"INFO\", timestamp: Optional[datetime] = None, )", "description": "Appends a log entry for a test run, useful for batch logging.", "scope": "", "scopeKind": ""}, {"name": "models.FailLog add_fail_log( db: Session, run_id: int, message: str, error_type: Optional[str] = None, case_result_id: Optional[int] = None, details: Optional[str] = None, )", "description": "Records a failure event, optionally tied to a specific test case result.", "scope": "", "scopeKind": ""}, {"name": "List[models.TestRun] get_recent_runs(db: Session, limit: int = 20)", "description": "Retrieves a list of recent test runs ordered by start time.", "scope": "", "scopeKind": ""}, {"name": "Optional[Tuple[int,int,int]] get_run_stats(db: Session, run_id: int)", "description": "Returns total cases, passed, and failed counts for a specific test run.", "scope": "", "scopeKind": ""}, {"name": "Tuple[int,int,int] count_case_status(db: Session, run_id: int)", "description": "Aggregates counts of passed, failed, and total test case results for a given test run.", "scope": "", "scopeKind": ""}], "calls": ["db.add", "db.commit", "db.refresh", "db.get", "db.execute", "db.scalars", "select", "func.sum", "func.count", "desc"], "search-terms": ["test run management", "SQLAlchemy ORM", "test case results", "logging", "pytest database integration", "Python database repository", "test result storage"], "state": 2, "file_id": 7, "knowledge_revision": 72, "git_revision": "c5de1e9ed602b1061dcd9bebae68292741a5f772", "revision_history": [{"15": ""}, {"22": "c5de1e9ed602b1061dcd9bebae68292741a5f772"}, {"72": "c5de1e9ed602b1061dcd9bebae68292741a5f772"}], "ctags": [{"_type": "tag", "name": "add_batch_log", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/db/repositories.py", "pattern": "/^def add_batch_log($/", "language": "Python", "typeref": "typename:models.BatchLog", "kind": "function", "signature": "( db: Session, run_id: int, message: str, level: str = \"INFO\", timestamp: Optional[datetime] = None, )"}, {"_type": "tag", "name": "add_case_result", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/db/repositories.py", "pattern": "/^def add_case_result($/", "language": "Python", "typeref": "typename:models.TestCaseResult", "kind": "function", "signature": "( db: Session, run_id: int, case_name: str, status: str, duration_sec: Optional[float] = None, message: Optional[str] = None, suite_name: Optional[str] = None, start_time: Optional[datetime] = None, end_time: Optional[datetime] = None, tags: Optional[str] = None, )"}, {"_type": "tag", "name": "add_fail_log", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/db/repositories.py", "pattern": "/^def add_fail_log($/", "language": "Python", "typeref": "typename:models.FailLog", "kind": "function", "signature": "( db: Session, run_id: int, message: str, error_type: Optional[str] = None, case_result_id: Optional[int] = None, details: Optional[str] = None, )"}, {"_type": "tag", "name": "count_case_status", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/db/repositories.py", "pattern": "/^def count_case_status(db: Session, run_id: int) -> Tuple[int, int, int]:$/", "language": "Python", "typeref": "typename:Tuple[int,int,int]", "kind": "function", "signature": "(db: Session, run_id: int)"}, {"_type": "tag", "name": "create_test_run", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/db/repositories.py", "pattern": "/^def create_test_run($/", "language": "Python", "typeref": "typename:models.TestRun", "kind": "function", "signature": "( db: Session, project: Optional[str] = None, suite_name: Optional[str] = None, total_cases: int = 0, logs_path: Optional[str] = None, )"}, {"_type": "tag", "name": "finalize_test_run", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/db/repositories.py", "pattern": "/^def finalize_test_run($/", "language": "Python", "typeref": "typename:Optional[models.TestRun]", "kind": "function", "signature": "( db: Session, run_id: int, status: str, passed: int, failed: int )"}, {"_type": "tag", "name": "get_recent_runs", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/db/repositories.py", "pattern": "/^def get_recent_runs(db: Session, limit: int = 20) -> List[models.TestRun]:$/", "language": "Python", "typeref": "typename:List[models.TestRun]", "kind": "function", "signature": "(db: Session, limit: int = 20)"}, {"_type": "tag", "name": "get_run_stats", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/src/db/repositories.py", "pattern": "/^def get_run_stats(db: Session, run_id: int) -> Optional[Tuple[int, int, int]]:$/", "language": "Python", "typeref": "typename:Optional[Tuple[int,int,int]]", "kind": "function", "signature": "(db: Session, run_id: int)"}], "hash": "29f87a3283c9b9b801e0a27ad69c092a", "format-version": 4, "code-base-name": "robotframework_backend", "filename": "robotframework_backend/src/db/repositories.py"}