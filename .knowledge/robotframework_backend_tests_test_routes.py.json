{"is_source_file": true, "format": "Python", "description": "This is a test module for the FastAPI-based robot framework backend, containing test cases for various API endpoints and behaviors related to running tests, retrieving logs, configurations, and states.", "external_files": ["src.api.robot_runner.controller", "src.core.settings", "src.db.repositories.create_test_run", "src.db.repositories.add_case_result", "src.db.repositories.finalize_test_run"], "external_methods": ["controller.get_current_run", "controller.get_log_file", "create_test_run", "add_case_result", "finalize_test_run"], "published": ["_force_run_finished"], "classes": [], "methods": [{"name": "ensure_sse_enabled(monkeypatch)", "description": "Fixture to ensure SSE is enabled during tests by monkeypatching settings.USE_SSE to True.", "scope": "", "scopeKind": ""}, {"name": "_force_run_finished(db_session, run_id: int, passed: int = 1, failed: int = 0, status_val: str = \"passed\")", "description": "Helper function to finalize a test run with specified status and counts.", "scope": "", "scopeKind": ""}, {"name": "test_run_and_stop_flow(app_client, db_session, monkeypatch, tmp_path)", "description": "Main test case that simulates starting a test run, completing it via a patched controller method, and then checks various API endpoints for correct behavior and responses, including logs, stats, case status, progress, and configuration.", "scope": "", "scopeKind": ""}, {"name": "test_logs_polling_fallback_when_sse_disabled(app_client, monkeypatch)", "description": "Tests behavior when SSE is disabled, ensuring the logs endpoint returns a 400 status and batch log returns an empty string.", "scope": "", "scopeKind": ""}, {"name": "test_config_get_put_and_list(app_client)", "description": "Tests configuration retrieval, update, and listing endpoints.", "scope": "", "scopeKind": ""}, {"name": "test_state_sync_and_get(app_client)", "description": "Tests state retrieval, synchronization, and lock endpoints.", "scope": "", "scopeKind": ""}, {"name": "test_fail_log_and_stats_404(app_client, db_session)", "description": "Tests behavior of stats and fail log endpoints when a run does not exist or has no data.", "scope": "", "scopeKind": ""}, {"name": "fake_execute_robot(*args, **kwargs)", "scope": "test_run_and_stop_flow", "scopeKind": "function", "description": "unavailable"}], "calls": ["asyncio.sleep", "controller.get_current_run", "controller.get_log_file", "os.makedirs", "open", "add_case_result", "_force_run_finished", "app_client.post", "app_client.get", "app_client.put", "app_client.get", "app_client.post", "app_client.get"], "search-terms": ["test_routes", "robotframework", "API endpoints", "test run flow", "SSE", "batch_log", "configuration", "state management", "test result finalization"], "state": 2, "file_id": 24, "knowledge_revision": 65, "git_revision": "", "ctags": [{"_type": "tag", "name": "_force_run_finished", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/tests/test_routes.py", "pattern": "/^def _force_run_finished(db_session, run_id: int, passed: int = 1, failed: int = 0, status_val: s/", "language": "Python", "kind": "function", "signature": "(db_session, run_id: int, passed: int = 1, failed: int = 0, status_val: str = \"passed\")"}, {"_type": "tag", "name": "ensure_sse_enabled", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/tests/test_routes.py", "pattern": "/^def ensure_sse_enabled(monkeypatch):$/", "language": "Python", "kind": "function", "signature": "(monkeypatch)"}, {"_type": "tag", "name": "fake_execute_robot", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/tests/test_routes.py", "pattern": "/^    async def fake_execute_robot(*args, **kwargs):$/", "file": true, "language": "Python", "kind": "function", "signature": "(*args, **kwargs)", "scope": "test_run_and_stop_flow", "scopeKind": "function"}, {"_type": "tag", "name": "test_config_get_put_and_list", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/tests/test_routes.py", "pattern": "/^def test_config_get_put_and_list(app_client):$/", "language": "Python", "kind": "function", "signature": "(app_client)"}, {"_type": "tag", "name": "test_fail_log_and_stats_404", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/tests/test_routes.py", "pattern": "/^def test_fail_log_and_stats_404(app_client, db_session):$/", "language": "Python", "kind": "function", "signature": "(app_client, db_session)"}, {"_type": "tag", "name": "test_logs_polling_fallback_when_sse_disabled", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/tests/test_routes.py", "pattern": "/^def test_logs_polling_fallback_when_sse_disabled(app_client, monkeypatch):$/", "language": "Python", "kind": "function", "signature": "(app_client, monkeypatch)"}, {"_type": "tag", "name": "test_run_and_stop_flow", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/tests/test_routes.py", "pattern": "/^async def test_run_and_stop_flow(app_client, db_session, monkeypatch, tmp_path):$/", "language": "Python", "kind": "function", "signature": "(app_client, db_session, monkeypatch, tmp_path)"}, {"_type": "tag", "name": "test_state_sync_and_get", "path": "/home/kavia/workspace/code-generation/automated-test-console-220183-220192/robotframework_backend/tests/test_routes.py", "pattern": "/^def test_state_sync_and_get(app_client):$/", "language": "Python", "kind": "function", "signature": "(app_client)"}], "hash": "49be1e49de3d9a40d47524f252b19b89", "format-version": 4, "code-base-name": "robotframework_backend", "filename": "robotframework_backend/tests/test_routes.py", "revision_history": [{"65": ""}]}